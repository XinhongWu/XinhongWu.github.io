<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录个人技术笔记与生活日志"><title>PLSQL Cursor使用方法研究 | 在路上</title><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.3"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.3"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css?v=2.0.3"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js?v=2.0.3"></script><script src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=2.0.3"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">PLSQL Cursor使用方法研究</h1><a id="logo" href="/.">在路上</a><p class="description">修心养性，健体强身，终生学习！</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">PLSQL Cursor使用方法研究</h1><div class="post-meta"><a href="/2019/04/12/PLSQL-Cursor使用方法研究/#comments" class="comment-count"></a><p><span class="date">Apr 12, 2019</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><h4 id="PLSQL-Cursor使用方法研究"><a href="#PLSQL-Cursor使用方法研究" class="headerlink" title="PLSQL Cursor使用方法研究"></a>PLSQL Cursor使用方法研究</h4><h5 id="1-Cursor的基本操作"><a href="#1-Cursor的基本操作" class="headerlink" title="1 Cursor的基本操作"></a>1 Cursor的基本操作</h5><h6 id="1-Cursor-Declare"><a href="#1-Cursor-Declare" class="headerlink" title="1) Cursor Declare"></a>1) Cursor Declare</h6><blockquote>
<blockquote>
<p>A cursor is a SELECT statement that is defined within the <em>declaration</em> section of your PLSQL code. We’ll take a look at three different syntaxes to declare a cursor.</p>
<p>游标是在PLSQL的声明部分定义的，表示一个Select Statement</p>
<p>最简单的不带参数的Cursor定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; &gt; CURSOR cursor_name</span><br><span class="line">&gt; &gt; IS</span><br><span class="line">&gt; &gt;   SELECT_statement;</span><br><span class="line">&gt; &gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>同时，也存在带参数的Cursor，<strong>游标的参数只能是入参</strong>，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; &gt; CURSOR c2 (subject_id_in IN varchar2)</span><br><span class="line">&gt; &gt; IS</span><br><span class="line">&gt; &gt;   SELECT course_number</span><br><span class="line">&gt; &gt;   FROM courses_tbl</span><br><span class="line">&gt; &gt;   WHERE subject_id = subject_id_in;</span><br><span class="line">&gt; &gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<p>同时，Cursor还可以指定返回类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CURSOR c3</span><br><span class="line">RETURN courses_tbl%ROWTYPE</span><br><span class="line">IS</span><br><span class="line">   SELECT *</span><br><span class="line">   FROM courses_tbl</span><br><span class="line">   WHERE subject = &apos;Mathematics&apos;;</span><br></pre></td></tr></table></figure>
<h6 id="2-Open-Cursor"><a href="#2-Open-Cursor" class="headerlink" title="2) Open Cursor"></a>2) Open Cursor</h6><p>Once you’ve <a href="https://www.techonthenet.com/oracle/cursors/declare.php" target="_blank" rel="noopener">declared your cursor</a>, the next step is to use the OPEN statement to open the cursor.</p>
<p>当声明cursor后，下一步就是使用open语句打开。</p>
<p>示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE Function FindCourse</span><br><span class="line">  ( name_in IN varchar2 )</span><br><span class="line">  RETURN number</span><br><span class="line">IS</span><br><span class="line">   cnumber number;</span><br><span class="line"></span><br><span class="line">   CURSOR c1</span><br><span class="line">   IS</span><br><span class="line">     SELECT course_number</span><br><span class="line">     FROM courses_tbl</span><br><span class="line">     WHERE course_name = name_in;</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">   OPEN c1;</span><br><span class="line">   FETCH c1 INTO cnumber;</span><br><span class="line"></span><br><span class="line">   if c1%notfound then</span><br><span class="line">      cnumber := 9999;</span><br><span class="line">   end if;</span><br><span class="line"></span><br><span class="line">   CLOSE c1;</span><br><span class="line"></span><br><span class="line">RETURN cnumber;</span><br><span class="line"></span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<p>注意：打开游标的目的是执行Select语句：</p>
<p>就是执行游标所对应的SELECT 语句，将其查询结果放入工作区，并且指针指向工作区的首部，标识游标结果集合。</p>
<p>如果游标查询语句中带有FOR UPDATE选项，OPEN 语句还将锁定数据库表中游标结果集合对应的数据行。</p>
<h6 id="3-Fetch-Cursor"><a href="#3-Fetch-Cursor" class="headerlink" title="3) Fetch Cursor"></a>3) Fetch Cursor</h6><p>The purpose of using a cursor, in most cases, is to retrieve the rows from your cursor so that some type of operation can be performed on the data. After <a href="https://www.techonthenet.com/oracle/cursors/declare.php" target="_blank" rel="noopener">declaring</a> and <a href="https://www.techonthenet.com/oracle/cursors/open.php" target="_blank" rel="noopener">opening</a> your cursor, the next step is to use the FETCH statement to fetch rows from your cursor.</p>
<p>使用游标的目的，在大多数的情况下，是提取游标中的row数据，来使得一些操作类型能够在数据上执行。在声明、打开游标之后，下一步是fetch数据。</p>
<p>fetch数据是指检索集合中的数据行，放入指定的输出变量中。</p>
<p>在执行<strong>fetch</strong>语句时，需要注意：</p>
<blockquote>
<p><strong>执行FETCH语句时，每次返回一个数据行，然后自动将游标移动指向下一个数据行。当检索到最后一行数据时，如果再次执行FETCH语句，将操作失败，并将游标属性%NOTFOUND置为TRUE。所以每次执行完FETCH语句后，检查游标属性%NOTFOUND就可以判断FETCH语句是否执行成功并返回一个数据行，以便确定是否给对应的变量赋了值。</strong></p>
</blockquote>
<h6 id="4-Close-Cursor"><a href="#4-Close-Cursor" class="headerlink" title="4) Close Cursor"></a>4) Close Cursor</h6><p>The final step of working with cursors is to close the cursor once you have finished using it.</p>
<p>完成Cursor的使用后，最后一步是<strong>close</strong>游标。</p>
<h5 id="2-Cursor-的使用技巧"><a href="#2-Cursor-的使用技巧" class="headerlink" title="2 Cursor 的使用技巧"></a>2 Cursor 的使用技巧</h5><p>游标，提供了一种对具有多行数据查询结果集中的每一行数据分别进行单独处理的方法，是设计嵌入式SQL语句的应用程序的常用编程方式。</p>
<table>
<thead>
<tr>
<th>SQL语句</th>
<th>游标</th>
</tr>
</thead>
<tbody>
<tr>
<td>非查询语句</td>
<td>隐式的</td>
</tr>
<tr>
<td>结果是单行的查询语句</td>
<td>隐式的或显示的</td>
</tr>
<tr>
<td>结果是多行的查询语句</td>
<td>显示的</td>
</tr>
</tbody>
</table>
<p><strong>从上表看出，显式的游标只在查询语句中出现。</strong></p>
<p>在前小节中出现的4个步骤，都是指显式游标的处理过程，与前一小节的Select Statement对应起来了。</p>
<h6 id="1-cursor不带参数的遍历方法"><a href="#1-cursor不带参数的遍历方法" class="headerlink" title="1) cursor不带参数的遍历方法"></a>1) cursor不带参数的遍历方法</h6><p>cursor存在几个重要的属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Cursor_name%FOUND     布尔型属性，当最近一次提取游标操作FETCH成功则为 TRUE,否则为FALSE；</span><br><span class="line"></span><br><span class="line">Cursor_name%NOTFOUND   布尔型属性，与%FOUND相反；</span><br><span class="line"></span><br><span class="line">Cursor_name%ISOPEN     布尔型属性，当游标已打开时返回 TRUE；</span><br><span class="line"></span><br><span class="line">Cursor_name%ROWCOUNT   数字型属性，返回已从游标中读取的记录数。</span><br><span class="line"></span><br><span class="line">Cursor_name%ROWTYPE   游标记录类型</span><br></pre></td></tr></table></figure>
<p>因此，可以使用<strong>FOUND</strong>标记来遍历多行的数据，示例的PLSQL的代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- Created on 2019/4/12 by CLARK </span><br><span class="line">declare </span><br><span class="line">  cursor c_cursor is select eno || salary,sales from employee;</span><br><span class="line">  v_ename employee.Partment%type;</span><br><span class="line">  v_sales employee.Sales%type;</span><br><span class="line">begin</span><br><span class="line">  open c_cursor;</span><br><span class="line">  fetch c_cursor into v_ename,v_sales;</span><br><span class="line">  while c_cursor%FOUND loop</span><br><span class="line">    dbms_Output.put_line(c_cursor%ROWCOUNT);</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(v_ename||&apos;---&apos;||to_char(v_sales) );</span><br><span class="line">    fetch c_cursor into v_ename,v_sales;</span><br><span class="line">  end loop;</span><br><span class="line">  if c_cursor%ISOPEN then</span><br><span class="line">     dbms_Output.put_line(&apos;true&apos;);</span><br><span class="line">  else</span><br><span class="line">     dbms_Output.put_line(&apos;false&apos;);</span><br><span class="line">  end if;</span><br><span class="line">  close c_cursor;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<h6 id="2-cursor带参数的遍历方法"><a href="#2-cursor带参数的遍历方法" class="headerlink" title="2) cursor带参数的遍历方法"></a>2) cursor带参数的遍历方法</h6><p>cursor 带参数时，参数将作用于Select Statement，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">  cursor cur(start_salary in number) is select eno,salary from employee where salary &gt; start_salary;</span><br><span class="line">  v_eno number;</span><br><span class="line">  v_salary number;</span><br><span class="line">begin</span><br><span class="line">  open cur(400);</span><br><span class="line">  loop</span><br><span class="line">    fetch cur into v_eno,v_salary;</span><br><span class="line">    exit when cur%NOTFOUND;</span><br><span class="line">    update employee set salary = salary - 11 where eno = v_eno;</span><br><span class="line">    commit;    </span><br><span class="line">  end loop;</span><br><span class="line">  </span><br><span class="line">exception</span><br><span class="line">  when others then</span><br><span class="line">    dbms_output.put_line(&apos;exception&apos;);</span><br><span class="line"></span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p><strong>可以使用游标来定义变量，比声明Record的方式要安全和方便，不易出错</strong>：通过使用Cursor的属性：<strong>ROWTYPE</strong>。</p>
<p>如下的方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">  cursor cur(start_salary in number) is select eno,salary from employee where salary &gt; start_salary;</span><br><span class="line">  e_record cur%ROWTYPE;</span><br><span class="line">begin</span><br><span class="line">  open cur(400);</span><br><span class="line">  loop</span><br><span class="line">    fetch cur into e_record;</span><br><span class="line">    exit when cur%NOTFOUND;</span><br><span class="line">    update employee set salary = e_record.salary - 11 where eno = e_record.eno;</span><br><span class="line">    commit;    </span><br><span class="line">  end loop;</span><br><span class="line">  </span><br><span class="line">exception</span><br><span class="line">  when others then</span><br><span class="line">    dbms_output.put_line(&apos;exception&apos;);</span><br><span class="line"></span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<h6 id="3-cursor-带参数且有返回值的用法"><a href="#3-cursor-带参数且有返回值的用法" class="headerlink" title="3) cursor 带参数且有返回值的用法"></a>3) cursor 带参数且有返回值的用法</h6><p>注意：尚未明确返回值的使用方法，本例的参考如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">DECLARE</span><br><span class="line">   TYPE emp_record_type IS RECORD(</span><br><span class="line">        f_name   employees.first_name%TYPE,</span><br><span class="line">        h_date   employees.hire_date%TYPE);</span><br><span class="line">   v_emp_record EMP_RECORD_TYPE;</span><br><span class="line"></span><br><span class="line">   CURSOR c3(dept_id NUMBER, j_id VARCHAR2) --声明游标,有参数有返回值</span><br><span class="line">          RETURN EMP_RECORD_TYPE</span><br><span class="line">   IS</span><br><span class="line">      SELECT first_name, hire_date FROM employees</span><br><span class="line">      WHERE department_id = dept_id AND job_id = j_id;</span><br><span class="line">BEGIN</span><br><span class="line">   OPEN c3(j_id =&gt; &apos;AD_VP&apos;, dept_id =&gt; 90);  --打开游标,传递参数值</span><br><span class="line">   LOOP</span><br><span class="line">      FETCH c3 INTO v_emp_record;    --提取游标</span><br><span class="line">      IF c3%FOUND THEN</span><br><span class="line">         DBMS_OUTPUT.PUT_LINE(v_emp_record.f_name||&apos;的雇佣日期是&apos;</span><br><span class="line">                            ||v_emp_record.h_date);</span><br><span class="line">      ELSE</span><br><span class="line">         DBMS_OUTPUT.PUT_LINE(&apos;已经处理完结果集了&apos;);</span><br><span class="line">         EXIT;</span><br><span class="line">      END IF;</span><br><span class="line">   END LOOP;</span><br><span class="line">   CLOSE c3;   --关闭游标</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<h5 id="3-Cursor-For-循环"><a href="#3-Cursor-For-循环" class="headerlink" title="3 Cursor For 循环"></a>3 Cursor For 循环</h5><h6 id="1）标准的针对游标For循环"><a href="#1）标准的针对游标For循环" class="headerlink" title="1）标准的针对游标For循环"></a>1）标准的针对游标For循环</h6><p>PLSQL提供了<strong>游标For循环</strong>语句，自动执行Open，Fetch，Close操作。</p>
<p>当进入循环时，游标FOR循环语句自动打开游标，并提取第一行游标数据，当程序处理完当前所提取的数据而进入下一次循环时，<br>游标FOR循环语句自动提取下一行数据供程序处理，当提取完结果集合中的所有数据行后结束循环，并自动关闭游标。</p>
<p>格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FOR index_variable IN cursor_name[(value[, value]…)] LOOP</span><br><span class="line">    -- 游标数据处理代码</span><br><span class="line">  END LOOP;</span><br></pre></td></tr></table></figure>
<p>index_variable 为游标FOR循环语句隐含声明的索引变量，可以认为是<strong>记录变量</strong>，<strong>其结构与游标查询语句返回的结构集合的结构相同</strong>。</p>
<p>可以通过<strong>index_variable</strong>来提取游标数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">  cursor cur(start_salary in number) is select eno,salary from employee where salary &gt; start_salary;</span><br><span class="line">  e_record cur%ROWTYPE;</span><br><span class="line">begin</span><br><span class="line">  for index_record in cur(200) Loop</span><br><span class="line">     update employee set salary = index_record.salary - 11 where eno = index_record.eno;</span><br><span class="line">     commit;</span><br><span class="line">  end loop;</span><br><span class="line">  </span><br><span class="line">exception</span><br><span class="line">  when others then</span><br><span class="line">    dbms_output.put_line(&apos;exception&apos;);</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>注意：如果在游标查询语句的选择列表中存在计算列，则必须要为其指定别名后才能通过游标FOR循环语句的索引访问。</p>
<p>例如在下面的例子中，需要进行统计行数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">  cursor cur is select count(1) as cnt from employee where salary &gt; 300;</span><br><span class="line">begin</span><br><span class="line">  for index_record in cur Loop</span><br><span class="line">     dbms_output.put_line(index_record.cnt);</span><br><span class="line">  end loop;</span><br><span class="line"></span><br><span class="line">exception</span><br><span class="line">  when others then</span><br><span class="line">    dbms_output.put_line(&apos;exception&apos;);</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>在游标的定义语句中，使用<code>select count(1) as cnt</code>来重命名，目的是为了在下面引用时可以访问到。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h6 id="2）子查询使用在游标For循环"><a href="#2）子查询使用在游标For循环" class="headerlink" title="2）子查询使用在游标For循环"></a>2）子查询使用在游标For循环</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line">    FOR c1_rec IN(SELECT department_name, location_id FROM departments) LOOP        </span><br><span class="line">		DBMS_OUTPUT.PUT_LINE(c1_rec.department_name||&apos;---&apos;||c1_rec.location_id);</span><br><span class="line">    END LOOP;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><blockquote><p>原文作者: Clark Wu</p><p>原文链接: <a href="http://yoursite.com/2019/04/12/PLSQL-Cursor使用方法研究/">http://yoursite.com/2019/04/12/PLSQL-Cursor使用方法研究/</a></p><p>版权声明: 转载请注明出处(必须保留作者署名及链接)</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/2019/04/17/PLSQL-包的使用/" class="pre">PLSQL 包的使用</a><a href="/2019/04/11/DML-DDL/" class="next">MySQL/Oracle DDL&amp;&amp;DML 温故知新</a></div><div id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC80MzIxNC8xOTc2MA=="></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#PLSQL-Cursor使用方法研究"><span class="toc-text">PLSQL Cursor使用方法研究</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Cursor的基本操作"><span class="toc-text">1 Cursor的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-Cursor-Declare"><span class="toc-text">1) Cursor Declare</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-Open-Cursor"><span class="toc-text">2) Open Cursor</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-Fetch-Cursor"><span class="toc-text">3) Fetch Cursor</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-Close-Cursor"><span class="toc-text">4) Close Cursor</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-Cursor-的使用技巧"><span class="toc-text">2 Cursor 的使用技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-cursor不带参数的遍历方法"><span class="toc-text">1) cursor不带参数的遍历方法</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-cursor带参数的遍历方法"><span class="toc-text">2) cursor带参数的遍历方法</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-cursor-带参数且有返回值的用法"><span class="toc-text">3) cursor 带参数且有返回值的用法</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-Cursor-For-循环"><span class="toc-text">3 Cursor For 循环</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1）标准的针对游标For循环"><span class="toc-text">1）标准的针对游标For循环</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2）子查询使用在游标For循环"><span class="toc-text">2）子查询使用在游标For循环</span></a></li></ol></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/06/30/HTTP-边学边记/">HTTP 边学边记</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/17/PLSQL-包的使用/">PLSQL 包的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/12/PLSQL-Cursor使用方法研究/">PLSQL Cursor使用方法研究</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/11/DML-DDL/">MySQL/Oracle DDL&&DML 温故知新</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/25/TCP/">TCP、UDP、Port、Socket 温故知新</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/21/VSCode与Git联合使用方法/">VSCode与Git联合使用方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/20/Python-调试技巧/">Python 调试技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/19/Golang-json-mysql-Data-Transfer/">Golang json && mysql Data Transfer</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/16/hello-world/">Qiniu Image Upload</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/16/test-my-site/">Hexo搭建个人博客站点のSpecil Tips</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">Clark Wu.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.3"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.3" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script><script>(function(d, s) {
  var j, e = d.getElementsByTagName('body')[0];
  if (typeof LivereTower === 'function') { return; }
  j = d.createElement(s);
  j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
  j.async = true;
  e.appendChild(j);
})(document, 'script');
</script></body></html>